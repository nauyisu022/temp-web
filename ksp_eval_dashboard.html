<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KSP 模型评测 - 500 条同数据源对比</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #fff;
      color: #24292f;
      margin: 0;
      padding: 2rem;
      line-height: 1.6;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
    .subtitle { color: #57606a; font-size: 0.9rem; margin-bottom: 1.5rem; }
    .metric-desc {
      background: #f6f8fa;
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin-bottom: 1.5rem;
      border: 1px solid #d0d7de;
    }
    .metric-desc h3 { font-size: 0.95rem; margin: 0.75rem 0 0.25rem 0; }
    .metric-desc h3:first-child { margin-top: 0; }
    .metric-desc p { margin: 0; font-size: 0.85rem; color: #57606a; }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    th, td {
      padding: 0.5rem 0.75rem;
      text-align: center;
      border: 1px solid #d0d7de;
    }
    th { background: #f6f8fa; font-weight: 600; }
    td:first-child { text-align: left; font-weight: 500; }
    td { background: #fff; }
    tr:nth-child(even) td { background: #f6f8fa; }
    .rank1 { background: #dafbe1 !important; font-weight: 500; }
    .rank2 { background: #ddf4ff !important; font-weight: 500; }
    .rank3 { background: #fff8c5 !important; font-weight: 500; }
  </style>
</head>
<body>
  <div class="container">
    <h1>KSP 模型评测</h1>
    <p class="subtitle">数据源：preprocessed_BR_first500.csv（同一批 500 条） · 评测时间：2026-02-24</p>
    <p class="subtitle" style="margin-top: -1rem;">注：Qwen3-8B 为 499 条，其余模型均为 500 条</p>

    <div class="metric-desc">
      <h3>一致率（identical_rate）</h3>
      <p>KSP 短语与搜索词库中某个搜索词<strong>完全一致</strong>（或词干化后一致）的比例。要求最严格。</p>
      <h3>短语命中率（hit_rate_phrase）</h3>
      <p>KSP 短语能被搜索词库<strong>匹配到</strong>（含子串、词干等）的比例。比一致率更宽松。</p>
      <h3>单词命中率（hit_rate_word）</h3>
      <p>KSP 拆词后，每个单词在搜索词库中能匹配到的比例。最宽松的指标。</p>
      <h3>FactScore（忠实度）</h3>
      <p>KSP 中的词有多少能在原文（title+description）中作为子串出现。越高表示越少编造。</p>
      <h3>L1 品牌品类一致率</h3>
      <p>top_attractiveness（brand、product_type、compatibility）层的短语与搜索词完全一致的比例。</p>
      <h3>L2 USP 一致率</h3>
      <p>unique_selling_points 层的短语与搜索词完全一致的比例。</p>
      <h3>L3 长尾词一致率</h3>
      <p>long_tail_keywords 层的短语与搜索词完全一致的比例。该层差距通常最大。</p>
    </div>

    <table>
      <thead>
        <tr>
          <th>指标</th>
          <th>Gemini 2.5 Flash</th>
          <th>Qwen3-8B nothink</th>
          <th>Qwen2.5-14B</th>
          <th>Qwen2.5-7B</th>
          <th>Qwen3-32B</th>
          <th>Qwen3.5 35B-A3B</th>
          <th>Qwen3-4B</th>
        </tr>
      </thead>
      <tbody id="main-table"></tbody>
    </table>
    <p class="subtitle" style="margin-top: -1rem;">
      <span style="background:#dafbe1;padding:2px 6px;border-radius:4px;">第1</span>
      <span style="background:#ddf4ff;padding:2px 6px;border-radius:4px;margin-left:4px;">第2</span>
      <span style="background:#fff8c5;padding:2px 6px;border-radius:4px;margin-left:4px;">第3</span>
    </p>
  </div>

  <script>
    const counts = [500, 499, 500, 500, 500, 500, 500];
    const data = {
      ir: [35.8, 30.2, 33.2, 34.4, 23.5, 18.5, 19.3],
      ph: [56.3, 48.1, 53.0, 54.4, 43.5, 33.9, 34.0],
      wh: [96.6, 96.7, 96.5, 95.6, 96.7, 96.4, 96.5],
      fs: [67.8, 62.9, 66.0, 64.9, 57.1, 60.8, 61.7],
      l1: [76.7, 66.1, 69.9, 71.1, 60.5, 52.5, 54.8],
      l2: [32.1, 30.6, 29.1, 30.2, 24.4, 19.7, 20.1],
      l3: [33.3, 18.2, 29.8, 32.5, 11.1, 7.2, 8.2]
    };
    const rows = [
      ['商品数', counts, v => v],
      ['一致率', data.ir, v => v + '%'],
      ['短语命中率', data.ph, v => v + '%'],
      ['单词命中率', data.wh, v => v + '%'],
      ['FactScore', data.fs, v => v + '%'],
      ['L1 品牌品类一致率', data.l1, v => v + '%'],
      ['L2 USP 一致率', data.l2, v => v + '%'],
      ['L3 长尾词一致率', data.l3, v => v + '%']
    ];

    function getRankClass(values, val) {
      const top3 = [...new Set(values)].sort((a, b) => b - a).slice(0, 3);
      const idx = top3.indexOf(val);
      if (idx === 0) return 'rank1';
      if (idx === 1) return 'rank2';
      if (idx === 2) return 'rank3';
      return '';
    }

    const tbody = document.getElementById('main-table');
    rows.forEach(([label, values, fmt]) => {
      const tr = document.createElement('tr');
      let html = `<td>${label}</td>`;
      const useRank = label !== '商品数';
      values.forEach((v) => {
        const cls = useRank ? getRankClass(values, v) : '';
        html += `<td class="${cls}">${fmt(v)}</td>`;
      });
      tr.innerHTML = html;
      tbody.appendChild(tr);
    });
  </script>
</body>
</html>
